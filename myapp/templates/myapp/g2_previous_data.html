
<html lang="en">

<style>
#.sidebar{

background-color: #d2d2d2;
border-color: #242424;

}
</style>
<head>
    {%block content1%}
    {%endblock%}

    {% load staticfiles %}<!--load static files-->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">


    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.css">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.min.js"></script>
    <script type="text/javascript" src="{% static 'myapp/js/graph.js' %}"></script>



   <!--  <title>Transbook</title> -->

    <!-- Bootstrap Core CSS -->
    <link href="{% static 'myapp/all/bootstrap/css/bootstrap.min.css'%}" rel="stylesheet">

    <!-- MetisMenu CSS -->
    <link href="{% static 'myapp/all/metisMenu/metisMenu.min.css'%}" rel="stylesheet">

    <!-- DataTables CSS -->
    <link href="{% static 'myapp/all/datatables-plugins/dataTables.bootstrap.css'%}" rel="stylesheet">

    <!-- DataTables Responsive CSS -->
    <link href="{% static 'myapp/all/datatables-responsive/dataTables.responsive.css'%}" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="{% static 'myapp/css/sb-admin-2.css'%}" rel="stylesheet">
    <link href="{% static 'myapp/css/ul_styles.css'%}" rel="stylesheet">
    <link href="{% static 'myapp/css/graph.css'%}" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="{% static 'myapp/all/font-awesome/css/font-awesome.min.css'%}" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>
<body style="background-image:url('{% static 'myapp/all/grad2.jpg'%}');background-size:100%;">
{%block mapcontent%}

{%endblock%}

	<nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0;1position :fixed; width: 100%;background-color: #d2d2d2; border-color: #242424; ">
	<center><div class="heading">Air Pollution Monitoring System</div></center>
        <!-- /.navbar-header -->
                <!-- /.navbar-static-side -->
    </nav>
<div class="navbar-default sidebar" role="navigation; background-color: #f0ad4e;">
            <div   id="cssmenu" class="sidebar-nav navbar-collapse">
                <ul class="nav previous" id="side-menu">

                    <li><a href="/iot">Sensors</a></li>
		    <li class="active"><a href="/previous"> Previous Data</a></li>

                    <li><a href="/analytics">Analytics</a></li>
                    <li><a href="/livemap">Recent Data</a></li>
                </ul>
            </div>
            <!-- /.sidebar-collapse rgb(115, 177, 63) green rgb(160, 158, 15)-->
        </div>
<center>
  <form action="" method="POST">
    {% csrf_token %}
    <button  type="submit" formaction="/previous/">Group1</button>
    <button type="submit" formaction="/previous2/">Group2</button>
    </form>
</center>
<center class="previouspage">
<div class="previousData-view">

    <center>
  <div class="buttons">
    <input type="button" value="1 month" class="m1 clicked" style="1border: 5px solid rgb(160, 158, 15);"/>
    <input type="button" value="3 months" class="m3" style="1border: 5px solid green;"/>
    <input type="button" value="6 months" class="m6" style="1border: 5px solid rgb(115, 177, 63);"/>
    <input type="button" value="1 year" class="y" style="1border: 5px solid #128c7c;"/>



  </div>

<div class="previousData-graphs">
        <div id="y-view" class="y-view" style="height: inherit; width:100%;border: 5px solid #128c7c;"></div>
        <div id="m6-view" class="m6-view" style="height:inherit;width:100%;border: 5px solid #128c7c ;"></div>
        <div id="m3-view" class="m3-view" style="height: inherit;width:100%;border: 5px solid #128c7c ;"></div>
        <div id="m1-view" class="m1-view" style="height: inherit;width:100%;border: 5px solid #128c7c ;"></div>
</div>

<div class="min" style="background-image:url('{% static 'myapp/all/green.jpg'%}');background-size:100%;">

	<span class="span_heading">Min value</span>
	<span class="down" style="background-image:url('{% static 'myapp/all/down.png'%}');background-size:80%;" ><b>{{min1.Sensor_value__min}}</b></span>
</div>
<div class="avg" style="background-image:url('{% static 'myapp/all/blue.jpg'%}');background-size:100%;">

	<span class="span_heading">Avg value</span>
	<span class="middle1" style="background-image:url('{% static 'myapp/all/middle.png'%}');background-size:85%;"><b>{{avg1}}</b></span>
</div>
<div class="max" style="background-image:url('{% static 'myapp/all/red.jpg'%}');background-size:100%;">

	<span class="span_heading">Max value</span>
	<span class="up" style="background-image:url('{% static 'myapp/all/up.png'%}');background-size:85%;"><b>{{max1.Sensor_value__max}}</b></span>
</div>


<span class="info">The Data is available from the date the device was setup i.e 06-04-2017 </span>
</center>
  </div>

  </center>      <!-- /#page-wrapper -->

</div>
    <!-- /#wrapper -->

    <!-- jQuery -->
      <script src="{% static 'myapp/all/jquery/jquery.min.js'%}"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="{% static 'myapp/all/bootstrap/js/bootstrap.min.js'%}"></script>

    <!-- Metis Menu Plugin JavaScript -->
    <script src="{% static 'myapp/all/metisMenu/metisMenu.min.js'%}"></script>

    <!-- DataTables JavaScript -->
    <script src="{% static 'myapp/all/datatables/js/jquery.dataTables.min.js'%}"></script>
    <script src="{% static 'myapp/all/datatables-plugins/dataTables.bootstrap.min.js'%}"></script>
    <script src="{% static 'myapp/all/datatables-responsive/dataTables.responsive.js'%}"></script>

    <!-- Custom Theme JavaScript -->
    <script src="{% static 'myapp/js/sb-admin-2.js'%}"></script>
  <script>

  function convert_to_24h(time_str) {
    // Convert a string like 10:05:23 PM to 24h format, returns like [22,5,23]
    var time = time_str.match(/(\w+) (\d+), (\d+), (\d+):(\d+) (\w)/);
    var month= time[1];
//alert(month);
if(month=="January"){month='01';}
if(month=="February"){month='02';}
if(month=="March"){month='03';}
if(month=="April"){month='04';}
if(month=="May"){month='05';}
if(month=="June"){month='06';}
if(month=="July"){month='07';}
if(month=="August"){month='08';}
if(month=="September"){month='09';}
if(month=="October"){month='10';}
if(month=="November"){month='11';}
if(month=="December"){month='12';}

	var day=Number(time[2]);
	var year=Number(time[3]);
    var hours = Number(time[4]);
    var minutes = Number(time[5]);
   // var month = Number(time[3]);
    var meridian = time[6].toLowerCase();

    if (meridian == 'p' && hours < 12) {
      hours = hours + 12;
    }
    else if (meridian == 'a' && hours == 12) {
      hours = hours - 12;
    }
//alert(day+"-"+month+"-"+year+" "+hours+":"+minutes);
    return (year+"-"+month+"-"+day+" "+hours+":"+minutes);
  };
//arrays for storing the 1year, 6months, 3months, 1month data
	var data1 = [];
	var data2 = [];
	var data1_y = [];
	var data2_y = [];
	var data1_6m = [];
	var data2_6m = [];
	var data1_3m = [];
	var data2_3m = [];
	var data1_1m = [];
	var data2_1m = [];
	var data1 = [];
	var data2 = [];
//push respective data into arrays
	data1_y[0]='2016-03-7 10:30';
	data2_y[0]=null;
	data1_6m[0]='2016-10-01 10:30';
	data2_6m[0]=null;
	data1_3m[0]='2017-01-01 10:30';
	data2_3m[0]=null;
	data1_1m[0]='2017-04-01 10:30';
	data2_1m[0]=null;
	{%for Sensor in sensors1 %}
		data1_y.push(convert_to_24h('{{Sensor.Sensor_date}}'));
		data2_y.push('{{Sensor.Sensor_value}}');
	{%endfor%}

	{%for Sensor in sensors2 %}
		data1_6m.push(convert_to_24h('{{Sensor.Sensor_date}}'));
		data2_6m.push('{{Sensor.Sensor_value}}');
	{%endfor%}

	{%for Sensor in sensors3 %}
		data1_3m.push(convert_to_24h('{{Sensor.Sensor_date}}'));
		data2_3m.push('{{Sensor.Sensor_value}}');
	{%endfor%}

	{%for Sensor in sensors4 %}
		data1_1m.push(convert_to_24h('{{Sensor.Sensor_date}}'));
		data2_1m.push('{{Sensor.Sensor_value}}');
	{%endfor%}

	/*{%for i in count1 %}
	alert(data2_y[{{i}}]);

	{%endfor%}*/




new Morris.Line({
  // ID of the element in which to draw the chart.
  element: 'y-view',

	  data: [

		{%for i in count1 %}
		{ year: data1_y[{{i}}] , value: data2_y[{{i}}]},
		{%endfor%}

		],

  xkey: 'year',
  ykeys: ['value'],
  labels: ['Value'],
pointFillColors:['#128c7c'],
  lineColors: ['#89d5cb']
  });

new Morris.Line({
  // ID of the element in which to draw the chart.
  element: 'm6-view',

	  data: [

		{%for i in count2 %}
		{ year: data1_6m[{{i}}] , value: data2_6m[{{i}}]},
		{%endfor%}

		],

  xkey: 'year',
  ykeys: ['value'],
  labels: ['Value'],
pointFillColors:['#128c7c'],
  lineColors: ['#89d5cb']
  });

new Morris.Line({
  // ID of the element in which to draw the chart.
  element: 'm3-view',

	  data: [

		{%for i in count3 %}
		{ year: data1_3m[{{i}}] , value: data2_3m[{{i}}]},
		{%endfor%}

		],

  xkey: 'year',
  ykeys: ['value'],
  labels: ['Value'],
pointFillColors:['#128c7c'],
  lineColors: ['#89d5cb']
  });


  new Morris.Line({
  // ID of the element in which to draw the chart.
  element: 'm1-view',

	  data: [

		{%for i in count4 %}
		{ year: data1_1m[{{i}}] , value: data2_1m[{{i}}]},
		{%endfor%}

		],

  xkey: 'year',
  ykeys: ['value'],
  labels: ['Value'],
pointFillColors:['#128c7c'],
  lineColors: ['#89d5cb']
  });

</script>


{%block drivertable%}
{%endblock%}
</body>

</html>
